enum CompanyType {
    INDIVIDUAL
    BUSINESS
}

enum CompanyStatus {
    PENDING
    APPROVED
    REJECTED
}

# Documents uploaded during company application
type ApplicationDocuments {
    identityDocumentUrl: String!
    businessRegistrationUrl: String
    insuranceCertificateUrl: String
    additionalDocuments: [String!]
}

input CompanyInfoInput {
    companyName: String!
    registrationNumber: String!
    taxId: String!
    companyStreet: String!
    companyCity: String!
    companyPostalCode: String!
    companyCounty: String
    companyCountry: String!
    businessType: String
}

input ApplicationDocumentsInput {
    identityDocument: Upload!
    businessRegistration: Upload
    insuranceCertificate: Upload
    additionalDocuments: [Upload!]
}

type Company {
    id: ID!
    adminUser: User! @goField(forceResolver: true)
    companyType: CompanyType!

    # Approval Status (drives UI state)
    status: CompanyStatus!
    rejectionReason: String

    # Company Information
    companyName: String!
    registrationNumber: String!
    taxId: String!
    companyStreet: String!
    companyCity: String!
    companyPostalCode: String!
    companyCounty: String
    companyCountry: String!
    businessType: String

    # Documents
    documents: ApplicationDocuments

    # Message from applicant
    message: String

    # Status
    isActive: Boolean!

    # Stats
    totalCleaners: Int!
    activeCleaners: Int!

    # Related Data
    cleaners: [CleanerProfile!]! @goField(forceResolver: true)

    createdAt: Time!
    updatedAt: Time!
}

input UpdateCompanyInput {
    companyName: String
    companyStreet: String
    companyCity: String
    companyPostalCode: String
    companyCounty: String
    businessType: String
    isActive: Boolean
}

input CreateCompanyInput {
    companyType: CompanyType!
    companyInfo: CompanyInfoInput!
    documents: ApplicationDocumentsInput!
    message: String
}

## QUERIES

extend type Query {
    # Get the current user's company (if they are a cleaner admin)
    myCompany: Company @authRequired

    # Get a company by ID (global admin only)
    company(id: ID!): Company @authRequired

    # List all companies (global admin only)
    companies: [Company!]! @authRequired

    # List pending companies awaiting approval (global admin only)
    pendingCompanies: [Company!]! @authRequired
}

## MUTATIONS

extend type Mutation {
    # Create a new company (CLEANER_ADMIN only, must not have existing company)
    createCompany(input: CreateCompanyInput!): Company! @authRequired

    # Update the current user's company (cleaner admin only)
    updateCompany(input: UpdateCompanyInput!): Company! @authRequired

    # Approve a company (global admin only)
    approveCompany(companyId: ID!): Company! @authRequired

    # Reject a company (global admin only)
    rejectCompany(companyId: ID!, reason: String): Company! @authRequired
}
